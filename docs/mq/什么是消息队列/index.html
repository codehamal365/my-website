<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-mq/什么是消息队列" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">什么是消息队列 | 我的小站</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://codehamal365.github.io/my-website/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://codehamal365.github.io/my-website/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://codehamal365.github.io/my-website/docs/mq/什么是消息队列"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="什么是消息队列 | 我的小站"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><link data-rh="true" rel="icon" href="/my-website/img/favicon copy.ico"><link data-rh="true" rel="canonical" href="https://codehamal365.github.io/my-website/docs/mq/什么是消息队列"><link data-rh="true" rel="alternate" href="https://codehamal365.github.io/my-website/docs/mq/什么是消息队列" hreflang="en"><link data-rh="true" rel="alternate" href="https://codehamal365.github.io/my-website/docs/mq/什么是消息队列" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/my-website/blog/rss.xml" title="我的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/my-website/blog/atom.xml" title="我的小站 Atom Feed"><link rel="stylesheet" href="/my-website/assets/css/styles.2d3f038e.css">
<script src="/my-website/assets/js/runtime~main.1d4761ae.js" defer="defer"></script>
<script src="/my-website/assets/js/main.7016ab77.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-website/"><div class="navbar__logo"><img src="/my-website/img/favicon copy.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-website/img/favicon copy.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">我的小站</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-website/docs/框架学习">文档</a><a class="navbar__item navbar__link" href="/my-website/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/codehamal365/my-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-website/docs/框架学习">框架学习</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/my-website/docs/category/工具">工具</a><button aria-label="Expand sidebar category &#x27;工具&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/my-website/docs/category/vue3">Vue3</a><button aria-label="Expand sidebar category &#x27;Vue3&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/my-website/docs/category/tint">Tint</a><button aria-label="Expand sidebar category &#x27;Tint&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-website/docs/aem/">AEM</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/my-website/docs/azure/Azure-apim">azure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/my-website/docs/git/git-commands">git</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/my-website/docs/mq/什么是消息队列">mq</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-website/docs/mq/什么是消息队列">什么是消息队列</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/my-website/docs/spring/@Value">spring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/my-website/docs/swagger/swagger-editor生成api文件">swagger</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/my-website/docs/uml/plantuml简介">uml</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-website/docs/文档">文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-website/docs/语言学习">语言学习</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/my-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">mq</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">什么是消息队列</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>什么是消息队列</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a class="hash-link" aria-label="Direct link to 前言" title="Direct link to 前言" href="/my-website/docs/mq/什么是消息队列#前言">​</a></h2>
<blockquote>
<p>只有光头才能变强。</p>
</blockquote>
<p>公司用到的很多技术，自己之前都没学过(<strong>尬</strong>)，于是只能慢慢补了。这次给大家写写我学习<strong>消息队列</strong>的笔记，希望对大家有帮助。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一什么是消息队列">一、什么是消息队列？<a class="hash-link" aria-label="Direct link to 一、什么是消息队列？" title="Direct link to 一、什么是消息队列？" href="/my-website/docs/mq/什么是消息队列#一什么是消息队列">​</a></h2>
<p>消息队列不知道大家看到这个词的时候，会不会觉得它是一个比较<strong>高端</strong>的技术，反正我是觉得它好像是挺牛逼的。</p>
<blockquote>
<p>消息队列，一般我们会简称它为MQ(Message Queue)，嗯，就是很直白的简写。</p>
</blockquote>
<p>我们先不管消息(Message)这个词，来看看队列(Queue)。这一看，队列大家应该都熟悉吧。</p>
<blockquote>
<p>队列是一种<strong>先进先出</strong>的数据结构。</p>
</blockquote>
<p>在Java里边，已经实现了不少的队列了：</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191624238-7852fdf5ba700f3834f7de3e222f5fdc.png" width="632" height="1462" class="img_ev3q"></p>
<p>那为什么还需要消息队列(MQ)这种<strong>中间件</strong>呢？？？其实这个问题，跟之前我学Redis的时候很像。Redis是一个以<code>key-value</code>形式存储的内存数据库，明明我们可以使用类似HashMap这种实现类就可以达到类似的效果了，那还为什么要Redis？《<a href="https://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==&amp;mid=2247484609&amp;idx=1&amp;sn=4c053236699fde3c2db1241ab497487b&amp;chksm=ebd745c0dca0ccd682e91938fc30fa947df1385b06d6ae9bb52514967b0736c66684db2f1ac9&amp;token=177635168&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Redis合集</a>》</p>
<ul>
<li>到这里，大家可以先猜猜为什么要用消息队列(MQ)这种<strong>中间件</strong>，下面会继续补充。</li>
</ul>
<p>消息队列可以简单理解为：<strong>把要传输的数据放在队列中</strong>。</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191624890-512dc7b4bbdc529ea3716bd116c9b5ec.png" width="820" height="640" class="img_ev3q"></p>
<p>科普：</p>
<ul>
<li>把数据放到消息队列叫做<strong>生产者</strong></li>
<li>从消息队列里边取数据叫做<strong>消费者</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二为什么要用消息队列">二、为什么要用消息队列？<a class="hash-link" aria-label="Direct link to 二、为什么要用消息队列？" title="Direct link to 二、为什么要用消息队列？" href="/my-website/docs/mq/什么是消息队列#二为什么要用消息队列">​</a></h2>
<p>为什么要用消息队列，也就是在问：用了消息队列有什么好处。我们看看以下的场景</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-解耦">2.1 解耦<a class="hash-link" aria-label="Direct link to 2.1 解耦" title="Direct link to 2.1 解耦" href="/my-website/docs/mq/什么是消息队列#21-解耦">​</a></h3>
<p>现在我有一个系统A，系统A可以产生一个<code>userId</code></p>
<p><img decoding="async" loading="lazy" alt="图片" src="data:image/png;base64,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" width="820" height="280" class="img_ev3q"></p>
<p>系统A可以产生一个UserId</p>
<p>然后，现在有系统B和系统C都需要这个<code>userId</code>去做相关的操作</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625379-c824b9fbe09c45d1b147d90d9ee9d00c.png" width="1080" height="531" class="img_ev3q">系统A给系统B和系统C传入userId这个值</p>
<p>写成伪代码可能是这样的：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class SystemA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 系统B和系统C的依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemB systemB = new SystemB();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemC systemC = new SystemC();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 系统A独有的数据userId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String userId = &quot;Java3y&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void doSomething() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 系统B和系统C都需要拿着系统A的userId去操作其他的事</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemB.SystemBNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemC.SystemCNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>结构图如下：</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625471-2a75d331cdebb92b148ee039d93498b1.png" width="1080" height="501" class="img_ev3q">结构图</p>
<p>ok，一切平安无事度过了几个天。</p>
<p>某一天，系统B的负责人告诉系统A的负责人，现在系统B的<code>SystemBNeed2do(String userId)</code>这个接口不再使用了，<strong>让系统A别去调它了</strong>。</p>
<p>于是，系统A的负责人说&quot;好的，那我就不调用你了。&quot;，于是就<strong>把调用系统B接口的代码给删掉了</strong>：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void doSomething() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 系统A不再调用系统B的接口了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //systemB.SystemBNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  systemC.SystemCNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>又过了几天，系统D的负责人接了个需求，也需要用到系统A的userId，于是就跑去跟系统A的负责人说：&quot;老哥，我要用到你的userId，你调一下我的接口吧&quot;</p>
<p>于是系统A说：&quot;没问题的，这 就搞&quot;</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625129-8685cc03abe75989b6a0c2ecb38bb08e.png" width="1080" height="710" class="img_ev3q">系统A需要调用系统D的接口</p>
<p>然后，系统A的代码如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class SystemA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 已经不再需要系统B的依赖了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // SystemB systemB = new SystemB();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 系统C和系统D的依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemC systemC = new SystemC();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemD systemD = new SystemD();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 系统A独有的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String userId = &quot;Java3y&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void doSomething() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 已经不再需要系统B的依赖了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //systemB.SystemBNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 系统C和系统D都需要拿着系统A的userId去操作其他的事</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemC.SystemCNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemD.SystemDNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>时间飞逝：</p>
<ul>
<li>又过了几天，系统E的负责人过来了，告诉系统A，需要userId。</li>
<li>又过了几天，系统B的负责人过来了，告诉系统A，还是重新掉那个接口吧。</li>
<li>又过了几天，系统F的负责人过来了，告诉系统A，需要userId。</li>
<li>……</li>
</ul>
<p>于是系统A的负责人，每天都被这给骚扰着，改来改去，改来改去…….</p>
<p>还有另外一个问题，调用系统C的时候，如果系统C挂了，系统A还得想办法处理。如果调用系统D时，由于网络延迟，请求超时了，那系统A是反馈<code>fail</code>还是重试？？</p>
<p>最后，系统A的负责人，觉得<strong>隔一段时间就改来改去</strong>，没意思，于是就跑路了。</p>
<p>然后，公司招来一个大佬，大佬经过几天熟悉，上来就说：<strong>将系统A的userId写到消息队列中，这样系统A就不用经常改动了</strong>。为什么呢？下面我们来一起看看：</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625609-2435815cf2c23bec387d34b8112db5c6.png" width="1080" height="604" class="img_ev3q">系统A将userId写到消息队列中，系统C和系统D从消息队列中拿数据</p>
<p>系统A将userId写到消息队列中，系统C和系统D从消息队列中拿数据。<strong>这样有什么好处</strong>？</p>
<ul>
<li>系统A<strong>只负责</strong>把数据写到队列中，谁想要或不想要这个数据(消息)，<strong>系统A一点都不关心</strong>。</li>
<li>即便现在系统D不想要userId这个数据了，系统B又突然想要userId这个数据了，都跟系统A无关，系统A一点代码都不用改。</li>
<li>系统D拿userId不再经过系统A，而是从消息队列里边拿。<strong>系统D即便挂了或者请求超时，都跟系统A无关，只跟消息队列有关</strong>。</li>
</ul>
<p>这样一来，系统A与系统B、C、D都<strong>解耦</strong>了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-异步">2.2 异步<a class="hash-link" aria-label="Direct link to 2.2 异步" title="Direct link to 2.2 异步" href="/my-website/docs/mq/什么是消息队列#22-异步">​</a></h3>
<p>我们再来看看下面这种情况：系统A还是<strong>直接调用</strong>系统B、C、D</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625109-2fe3a18b0e8a9575787b8b3a5bb76763.png" width="1080" height="494" class="img_ev3q">直接调接口</p>
<p>代码如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class SystemA {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemB systemB = new SystemB();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemC systemC = new SystemC();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SystemD systemD = new SystemD();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 系统A独有的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String userId ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void doOrder() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 下订单</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          userId = this.order();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 如果下单成功，则安排其他系统做一些事  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemB.SystemBNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemC.SystemCNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        systemD.SystemDNeed2do(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>假设</strong>系统A运算出userId具体的值需要50ms，调用 系统B的接口需要300ms，调用系统C的接口需要300ms，调用系统D的接口需要300ms。那么这次请求就需要<code>50+300+300+300=950ms</code></p>
<p>并且我们得知，系统A做的是<strong>主要的业务</strong>，而系统B、C、D是<strong>非主要</strong>的业务。比如系统A处理的是<strong>订单下单</strong>，而系统B是订单下单成功了，那发送一条短信告诉具体的用户此订单已成功，而系统C和系统D也是处理一些小事而已。</p>
<p>那么此时，为了<strong>提高用户体验和吞吐量</strong>，其实可以<strong>异步地</strong>调用系统B、C、D的接口。所以，我们可以弄成是这样的：</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191625091-c228b97eed09a1366e290032a626732f.png" width="1080" height="577" class="img_ev3q">此时才用了100ms</p>
<p>系统A执行完了以后，将userId写到消息队列中，然后就直接返回了(至于其他的操作，则异步处理)。</p>
<ul>
<li>本来整个请求需要用950ms(同步)</li>
<li>现在将调用其他系统接口异步化，从请求到返回只需要100ms(异步)</li>
</ul>
<p>(例子可能举得不太好，但我觉得说明到点子上就行了，见谅。)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23削峰限流">2.3削峰/限流<a class="hash-link" aria-label="Direct link to 2.3削峰/限流" title="Direct link to 2.3削峰/限流" href="/my-website/docs/mq/什么是消息队列#23削峰限流">​</a></h3>
<p>我们再来一个场景，现在我们每个月要搞一次大促，大促期间的并发可能会很高的，比如每秒3000个请求。假设我们现在有两台机器处理请求，并且每台机器只能每次处理1000个请求。</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191626012-2336b80c5c6cff144d97e4abf4a139ad.png" width="1080" height="641" class="img_ev3q">削峰的场景</p>
<p>那多出来的1000个请求，可能就把我们<strong>整个系统给搞崩了</strong>…所以，有一种办法，我们可以写到消息队列中：</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191626505-23855f67fe29a7ac9a1706ad391881e6.png" width="1080" height="599" class="img_ev3q">写到消息队列中，系统从消息队列中拿到请求</p>
<p>系统B和系统C<strong>根据自己的能够处理的请求数去消息队列中拿数据</strong>，这样即便有每秒有8000个请求，那只是把请求放在消息队列中，去拿消息队列的消息<strong>由系统自己去控制</strong>，这样就不会把整个系统给搞崩。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三使用消息队列有什么问题">三、使用消息队列有什么问题？<a class="hash-link" aria-label="Direct link to 三、使用消息队列有什么问题？" title="Direct link to 三、使用消息队列有什么问题？" href="/my-website/docs/mq/什么是消息队列#三使用消息队列有什么问题">​</a></h2>
<p>经过我们上面的场景，我们已经可以发现，消息队列能做的事其实还是蛮多的。</p>
<p>说到这里，我们先回到文章的开头，&quot;明明JDK已经有不少的队列实现了，我们还需要消息队列中间件呢？&quot;其实很简单，JDK实现的队列种类虽然有很多种，但是都是<strong>简单的内存队列</strong>。为什么我说JDK是简单的内存队列呢？下面我们来看看要实现消息队列(中间件)<strong>可能要考虑什么问题</strong>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="31高可用">3.1高可用<a class="hash-link" aria-label="Direct link to 3.1高可用" title="Direct link to 3.1高可用" href="/my-website/docs/mq/什么是消息队列#31高可用">​</a></h2>
<p>无论是我们使用消息队列来做解耦、异步还是削峰，消息队列<strong>肯定不能是单机</strong>的。试着想一下，如果是单机的消息队列，万一这台机器挂了，那我们整个系统几乎就是不可用了。</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191626549-d4e238e2e94c0ad2bf5df4e36783e25a.png" width="1080" height="590" class="img_ev3q">万一单机的队列挂掉了</p>
<p>所以，当我们项目中使用消息队列，都是得<code>集群/分布式</code>的。要做<code>集群/分布式</code>就必然希望该消息队列能够提供<strong>现成</strong>的支持，而不是自己写代码手动去实现。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-数据丢失问题">3.2 数据丢失问题<a class="hash-link" aria-label="Direct link to 3.2 数据丢失问题" title="Direct link to 3.2 数据丢失问题" href="/my-website/docs/mq/什么是消息队列#32-数据丢失问题">​</a></h3>
<p>我们将数据写到消息队列上，系统B和C还没来得及取消息队列的数据，就挂掉了。<strong>如果没有做任何的措施，我们的数据就丢了</strong>。</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/my-website/assets/images/202203191626492-29d4c5ea5d8464cf66a22f637b6b773c.png" width="1080" height="725" class="img_ev3q">数据丢失问题</p>
<p>学过Redis的都知道，Redis可以将数据持久化磁盘上，万一Redis挂了，还能从磁盘从将数据恢复过来。同样地，消息队列中的数据也需要存在别的地方，这样才尽可能减少数据的丢失。</p>
<p>那存在哪呢？</p>
<ul>
<li>磁盘？</li>
<li>数据库？</li>
<li>Redis？</li>
<li>分布式文件系统？</li>
</ul>
<p>同步存储还是异步存储？</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33消费者怎么得到消息队列的数据">3.3消费者怎么得到消息队列的数据？<a class="hash-link" aria-label="Direct link to 3.3消费者怎么得到消息队列的数据？" title="Direct link to 3.3消费者怎么得到消息队列的数据？" href="/my-website/docs/mq/什么是消息队列#33消费者怎么得到消息队列的数据">​</a></h3>
<p>消费者怎么从消息队列里边得到数据？有两种办法：</p>
<ul>
<li>生产者将数据放到消息队列中，消息队列有数据了，<strong>主动叫</strong>消费者去拿(俗称push)</li>
<li>消费者不断去<strong>轮训</strong>消息队列，看看有没有新的数据，如果有就消费(俗称pull)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34其他">3.4其他<a class="hash-link" aria-label="Direct link to 3.4其他" title="Direct link to 3.4其他" href="/my-website/docs/mq/什么是消息队列#34其他">​</a></h3>
<p>除了这些，我们在<strong>使用的时候</strong>还得考虑各种的问题：</p>
<ul>
<li>消息重复消费了怎么办啊？</li>
<li>我想保证消息是<strong>绝对</strong>有顺序的怎么做？</li>
<li>……..</li>
</ul>
<p>虽然消息队列给我们带来了那么多的好处，但同时我们发现引入消息队列也会<strong>提高系统的复杂性</strong>。市面上现在已经有不少消息队列轮子了，每种消息队列都有自己的特点，<strong>选取哪种MQ还得好好斟酌</strong>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="最后">最后<a class="hash-link" aria-label="Direct link to 最后" title="Direct link to 最后" href="/my-website/docs/mq/什么是消息队列#最后">​</a></h2>
<p>本文主要讲解了什么是消息队列，消息队列可以为我们带来什么好处，以及一个消息队列可能会涉及到哪些问题。希望给大家带来一定的帮助。</p>
<p>参考资料：</p>
<ul>
<li>
<p>Kafka简明教程</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/37405836" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/37405836</a></p>
</blockquote>
</li>
<li>
<p>消息队列使用的四种场景介绍，有图有解析，一看就懂</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/55712984" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/55712984</a></p>
</blockquote>
</li>
<li>
<p>消息队列设计精要</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/21479556" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/21479556</a></p>
</blockquote>
</li>
<li>
<p>消息队列的使用场景是怎样的</p>
<blockquote>
<p><a href="https://www.zhihu.com/question/34243607" target="_blank" rel="noopener noreferrer">https://www.zhihu.com/question/34243607</a></p>
</blockquote>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/mq/什么是消息队列.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/my-website/docs/git/git-commands"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Git命令清单</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/my-website/docs/spring/@Value"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">@Value</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#前言">前言</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#一什么是消 息队列">一、什么是消息队列？</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#二为什么要用消息队列">二、为什么要用消息队列？</a><ul><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#21-解耦">2.1 解耦</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#22-异步">2.2 异步</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#23削峰限流">2.3削峰/限流</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#三使用消息队列有什么问题">三、使用消息队列有什么问题？</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#31高可用">3.1高可用</a><ul><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#32-数据丢失问题">3.2 数据丢失问题</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#33消费者怎么得到消息队列的数据">3.3消费者怎么得到消息队列的数据？</a></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#34其他">3.4其他</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/my-website/docs/mq/什么是消息队列#最后">最后</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-website/docs/框架学习">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-website/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>